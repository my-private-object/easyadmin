<!DOCTYPE>
<html>
<head>
	<title>中国近代文献资源全库</title>
	<meta charset="utf-8" />
	<link rel="icon" href=" " type="image/x-icon" />
	<link rel="shortcut icon" href=" " type="image/x-icon" />
	<link rel="stylesheet" type="text/css" href="__STATIC__/qian/css/resources_list.css" />
	<link rel="stylesheet" type="text/css" href="__STATIC__/qian/css/last.css" />
	<script type="text/javascript" src="__STATIC__/qian/js/jquery.min.js" charset="utf-8"></script>
</head>
<body>
<div id="app" >
	
	{include file="common/header" /}

	<div id="entrance" >
		<div id="entrance_div" >
		<div id="entrance_left" >
			<a href="{:url('/gj/index')}">
			<img style="width:540px;height:90px;margin-top:36px;" src='__STATIC__/qian/images/header.png'>
			</a>
		</div>
		<ul id="entrance_right" >

			{if condition="$data['topData']['top_cate'] eq '' "}
			<li><span class="cate_id" style="cursor:pointer;margin-left:248px;color:red;" href="{:url('/gj/index/index')}" >首页</span></li>
			{else/}
			<li><span class="cate_id" style="cursor:pointer;margin-left:248px;" href="{:url('/gj/index/index')}" >首页</span></li>
			{/if}
			
			{volist name="$data['topData']['top_list']" id="vo"}
			{if condition="$vo['id'] eq $data['topData']['top_cate'] "}					
			<li><span class="cate_id" style="cursor:pointer;color:red;" href="{:url('/gj/index/sidepage')}" value="{$vo['id']}" is_top="1">{$vo['title']}</span></li>
			{else/}
			<li><span class="cate_id" style="cursor:pointer" href="{:url('/gj/index/sidepage')}" value="{$vo['id']}" is_top="">{$vo['title']}</span></li>
			{/if}
			{/volist}
		</ul>
		</div>
	</div>
	<div id="all_search" >
		<div id="all_search_div">
			<div id="complex_search" >
				<div id="resources_search" >资源搜索</div>
				<div id="search_box" ><input id="search_key" type="text" maxlength="45" /></div>
				<div id="search_button" >
					<span class="search" style="cursor:pointer;" href="{:url('/gj/index/searchPage')}">搜索</span>
				</div>
				<div id="high_search" ><a href="{:url('/gj/index/highSearchPage')}">高级搜索</a></div>
			</div>
			<div id="all_field" >
				<!-- <form action="" method="get">  -->
				<ul id="checkbox-d">
					<li>全部字段</li>
					<li><input name="Fruit" type="checkbox" value="1" />题名 </li>
					<li><input name="Fruit" type="checkbox" value="2" />时间 </li>
					<li><input name="Fruit" type="checkbox" value="3" />著者 </li>
					<li><input name="Fruit" type="checkbox" value="4" />出版机构 </li>
					<li><input name="Fruit" type="checkbox" value="5" />出版地 </li>	
				</ul>
				<!-- </form>  -->
			</div>
			<div id="hot_search" >
				<ul>
					<li>热门搜索:</li>
					<li><a href="#">中国</a></li>
					<li><a href="#">近代</a></li>
					<li><a href="#">文学</a></li>
					<li><a href="#">宗教</a></li>
				</ul>
			</div>
		</div>
	</div>
	<div id="resources" >

		<div id="tree_list" >
			<div id="left_header">
				<div class="left_header_name">XX分类法</div>
			</div>
			<ul id="header_ul">
				{volist name="$data['leftData']['left_list']" id="vo"}
				{if condition="$vo['pid'] eq $data['topData']['top_cate']"}
				<li class="nav">
					<div class="left_title">
					{if condition="$vo['id'] eq $data['leftData']['left_cate'] "}					
					<span class="cate_bid" style="cursor:pointer" href="{:url('/gj/index/sidepage')}" value="{$vo['id']}" is_left="1">{$vo['title']}</span>
					{else/}
					<span class="cate_bid" style="cursor:pointer" href="{:url('/gj/index/sidepage')}" value="{$vo['id']}" is_left="">{$vo['title']}</span>
					{/if}
					<span class="symbol" style="cursor:pointer; float:right; margin-right:22px;" >+</span>
					</div>
					{volist name="$data['leftData']['left_list']" id="two_vo"}
					{if condition="$two_vo['pid'] eq $vo['id']"}
					<ul style="margin-top: 5px;" hidden>
						<li>
							{if condition="$two_vo['id'] eq $data['leftData']['left_cate'] "}			
							<span class="cate_wbid" style="cursor:pointer" href="{:url('/gj/index/sidepage')}" value="{$two_vo['id']}" is_left="1">{$two_vo['title']}</span>
							{else/}
							<span class="cate_wbid" style="cursor:pointer" href="{:url('/gj/index/sidepage')}" value="{$two_vo['id']}" is_left="">{$two_vo['title']}</span>
							{/if}
						</li>
					</ul>
					{/if}
					{/volist}
				</li>
				{/if}
				{/volist}

				<!-- <li class="nav" >
					<span id="app" style="display:inline-block; width: 200px;" >宗教</span>
					<span class="symbol" style="cursor:pointer;" >+</span>
					<ul style="margin-top: 5px;" hidden>
						<li><a href="#">宗教aaaa</a></li>
						<li><a href="#">宗教bbbb</a></li>
					</ul>
				</li> -->
			<!-- 	<li>社会科学</li>
				<li>政治</li>
				<li>法律</li>
				<li>军事</li>
				<li>经济</li>
				<li>文化</li>
				<li>艺术</li>
				<li>教育</li>
				<li>语言</li>
				<li>文学</li>
				<li>历史、地理</li>
				<li>自然科学</li>
				<li>医学</li>
				<li>农业科学</li>
				<li>工业技术</li>
				<li>交通运输</li>
				<li>综合性图书</li>
				<li>其他</li> -->
			</ul>
		</div>
		<div id="books_list" >
			<div id="navigation" >
				<div id="navigation_content" >
					<span>当前位置：</span>
					<a href="#">首页</a> / <a href="#">图书</a> / <a href="#">军事</a>
				</div>
				<div id="sort" >
					<div id="sort_content" >
						<span><a href="#">图片</a> / <a href="#">列表</a></span>
						<span style="margin-left: 20px" >
							<a href="#">点击量排序</a> / 
							<a href="#">首字母排序</a> / 
							<a href="#">时间排序</a>
						</span>
					</div>
				</div>
			</div>

			<div id="content_list" >

				<!-- <div id="sort" >
					<div id="sort_content" >
						<span style="float:left;"><a href="#">图片</a> / <a href="#">列表</a></span>
						<span style="float:right;">
							<a href="#">点击量排序</a> / 
							<a href="#">首字母排序</a> / 
							<a href="#">时间排序</a>
						</span>
					</div>
				</div> -->
				<ul>
					{volist name="$data['rightData']['list']" id="vo" mod="2"}

					{eq name="mod" value="1"}
					<li style="margin-top: 15px; margin-left: 15px;">
					{/eq}
					{eq name="mod" value="0"}
					<li style="margin-top: 15px; margin-left: 15px; ">
					{/eq}
						<div class="content_image">
							<a href="{:url('/gj/index/details',['book'=>$vo.id] )}" target="_blank" >
								<img src="{$vo.logo}" />
							</a>
						</div>
						<div class="content_info">
							<div class="info_frame" style="margin-top: 20px; " >
								<span class="info_list" style="color:#446D6D;width:57px;">书&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;名:</span>
								<a href="{:url('/gj/index/details',['book'=>$vo.id] )}" target="_blank">
									<span class="info_list" style="color:black;">{$vo.title}</span>
								</a>
							</div>
							<div class="info_frame" >
								<span class="info_list" style="color:#446D6D;width:57px;">著&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;者:</span>
								<!-- <a href="#"> -->
								<span class="info_list" style="color:black;">{$vo.id}{$vo.title}</span>
								<!-- </a> -->
							</div>
							<div class="info_frame" >
								<span class="info_list" style="color:#446D6D;width:57px;">出版机构:</span>
								<!-- <a href="#"> -->
									<span class="info_list">{$vo.id}{$vo.title}</span>
								<!-- </a> -->
							</div>
							<div class="info_frame" >
								<span class="info_list" style="color:#446D6D;width:57px;">出版时间:</span>
								<!-- <a href="#"> -->
									<span class="info_list">{$vo.id}{$vo.title}</span>
								<!-- </a> -->
							</div>
						</div>
						<div class="content_href">
							<a href="{:url('/gj/index/details',['book'=>$vo.id] )}" target="_blank" style="margin-left: 2px;" >阅读</a>
							<a href="#" style="margin-left: 60px;">收藏</a>
							<a href="{:url('/gj/index/details',['book'=>$vo.id] )}" target="_blank" style="margin-left: 160px;">详情</a>
						</div>
					</li>
					{/volist}
					<!-- <li class="content" style="margin: 5 0 0 20" >
						<div class="content_image"><a href="#"><img src="" /></a></div>
						<div class="content_info">
							<div class="info_frame" style="margin: 0" >
								<a href="#">书&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;名:</a>
								<span class="info_list" >aaa</span><br>
							</div>
							<div class="info_frame" >
								<a href="#">著&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;者:</a>
								<span class="info_list" >bbb</span>
							</div>
							<div class="info_frame" >
								<a href="#">出版机构:</a>
								<span class="info_list" >ccc</span>
							</div>
							<div class="info_frame" >
								<a href="#">出版时间:</a>
								<span class="info_list" >ddd</span>
							</div>
						</div>
						<div class="content_href">
							<a href="#" style="margin: 10" >阅读</a>
							<a href="#">收藏</a>
							<a href="#">详情</a>
						</div>
					</li>-->
					<div style=" clear:both;"></div>
				</ul>
				<div style=" clear:both;"></div>
			</div>

			<div id="page">
				<span> 
					<span>
					<span>第</span> 
					<span>{$data['rightData']['page']['now_page']}</span>/
					<span>{$data['rightData']['page']['all_page']}</span><span> 页 共: </span>
					<span>{$data['rightData']['page']['count']}</span><span> 册  </span>
					</span>
					<span>
					<span class="page" style="cursor:pointer; " href="{:url('/gj/index/sidepage')}" page="1"> 首页 </span>
					<span class="page" style="cursor:pointer" href="{:url('/gj/index/sidepage')}" page="{$data['rightData']['page']['up_page']}"> 上一页 </span>
					<span class="page" style="cursor:pointer" href="{:url('/gj/index/sidepage')}" page="{$data['rightData']['page']['down_page']}"> 下一页 </span>
					<span class="page" style="cursor:pointer" href="{:url('/gj/index/sidepage')}" page="{$data['rightData']['page']['all_page']}"> 尾页 </span>
					</span>
				</span>
				<span id="jump_page" style="margin:4 10 0 20; vertical-align:text-bottom;" >
					<input type="text" name="jump_page" size="1" maxlength="4" />
				</span>					
				<span>
					<span class="page" style="cursor:pointer" href="{:url('/gj/index/sidepage')}" page="jump_page"> 跳转 </span>
				</span>
			</div>
		</div>
	</div>
	

	{include file="common/last" /}


</div>
</body>

</html>

<form>
	<botton id="test"></botton>
</form>
<script type="text/javascript">

$(".symbol").on("click",function(){

	if ($(this).parent().nextAll().is(':hidden')) {
		$(this).parent().nextAll().show()
		$(this).html('-')
	} else{
		$(this).parent().nextAll().hide()
		$(this).html('+')
	}

})

$("span").on("click",function(){

	// 获取当前 分类的基本属性 value 类别值，href 连接，class 类别属性 用来判定 1级或2级
	var href = $(this).attr('href');
	var value = $(this).attr('value');
	var class_name = $(this).attr('class');

	var cate_id = '';
	var cate_bid = '';
	var cate_wbid = '';

	if (class_name == 'cate_id') {				// 1级分类的跳转

		// 判断上部分类无类别 或 没有指定类别
		if ( typeof(value) == "undefined" ) {
			cate_id = '';
		} else {
			cate_id = value;
		}
		
		submitForm(href, cate_id, cate_bid, cate_wbid)

 	} else if(class_name == 'cate_bid') {		// 2级分类的跳转

 		var cate_id = getTopMenuCate();
		cate_bid = value; 
		submitForm(href, cate_id, cate_bid, cate_wbid)

 	} else if(class_name == 'cate_wbid') {

 		var cate_id = getTopMenuCate();
 		cate_wbid = value;
 		submitForm(href, cate_id, cate_bid, cate_wbid)

 	} else if(class_name == 'page') {			// 分页的跳转

 		page($(this));

 	} else if ( class_name == 'search' ) {

 		var checkbox = '';

 		$("input[name='Fruit']:checked").each(function (index, item) {
        
	        if ($("input[name='Fruit']:checked").length-1==index) {
	            checkbox += $(this).val();
	        } else {
	            checkbox += $(this).val() + ",";
	        }  
	    });

 		var searchValue = $("#search_key").val();

 		// 循环赋值第一分类
 		$(".cate_id").each(function(ii,vv){
		    //ii 指第几个元素的序列号。
		    //vv 指遍历得到的元素。
		    if ($(vv).attr('is_top') == 1) {
		    	// console.log($(vv).html());
		    	// console.log($(vv).attr('value'));
		    	cate_id = $(vv).attr('value')
		    }
		});

 		submitForm(href, cate_id, cate_bid, cate_wbid, page, searchValue, checkbox);

 	}


});

// 获取上部分类的指向
function getTopMenuCate() {
	
	obj = $("span[is_top = 1]");
	cate_id = obj.attr('value');

	// 判断上部分类无类别 或 没有指定类别
	if ( typeof(cate_id) == "undefined" ) {
		cate_id = '';
	}

	return cate_id;

}


// 获取左侧分类的指向
function getLeftMenuCate() {

	var cate_bid = '';
	var cate_wbid = '';

	// 获取左侧分类的指向
	obj = $("span[is_left = 1]");
	value = obj.attr('value');
	class_name = obj.attr('class');

	// 获取左侧类别
	if (class_name == 'cate_bid') {
		cate_bid = value;
	} else if (class_name == 'cate_wbid') {
		cate_wbid = value; 
	}

	// 判断左侧分类无类别 或 没有指定类别
	if ( typeof(cate_bid) == "undefined") {
		cate_bid = '';
	} else if ( typeof(cate_wbid) == "undefined" ) {
		cate_wbid = '';
	} 

	data = {};
	data.cate_bid = cate_bid;
	data.cate_wbid =cate_wbid;

 	return data;

}

// 分页提交
function page(e, cate_id, leftCate ) {

	 	// 获取 page 基本属性 - page 页码数，href 连接
 		page = $(e).attr('page');
 		href = $(e).attr('href');

 		// 判断 input 输入框跳转
 		if ( page == 'jump_page') {
 			page = $("input[name='jump_page']").val();
 		}

 		// 获取上部分类ID
 		var cate_id = getTopMenuCate();
 		// 获取左侧分类ID
 		var left_cate = getLeftMenuCate();

 		submitForm(href, cate_id, left_cate.cate_bid, left_cate.cate_wbid, page)

}


// 表单提交
function submitForm(href, cate_id, cate_bid='', cate_wbid='', page='', searchValue='', checkbox='') {

    $("body").append("<form></form>");
    // $("body").find("form").attr("action", 'http://localhost:81'+href);
    $("body").find("form").attr("action", href);
    // $("body").find("form").attr("action", {:url('Index/index/test')});
    $("body").find("form").attr("method", "post");
    $("body").find("form").attr("style", "display:none");
    // $.each(params, function (k, v) {
    // $("body").find("form").append("<input type='text' name='" + field + "' value = '" + value + "'></input>");
    $("body").find("form").append("<input type='text' name='" + 'top_cate' + "' value = '" + cate_id + "'></input>");
    $("body").find("form").append("<input type='text' name='" + 'left_cate[cate_bid]' + "' value = '" + cate_bid + "'></input>");
    $("body").find("form").append("<input type='text' name='" + 'left_cate[cate_wbid]' + "' value = '" + cate_wbid + "'></input>");
    $("body").find("form").append("<input type='text' name='" + 'page' + "' value = '" + page + "'></input>");
     $("body").find("form").append("<input type='text' name='" + 'search' + "' value = '" + searchValue + "'></input>");
    // });
    $("body").find("form").submit();

}
	

// 分页提交 - 备份
// function page(e, cate_id, leftCate ) {

	// 获取 page 基本属性 - page 页码数，href 连接
	// page = $(e).attr('page');
	// href = $(e).attr('href');

	// 获取左侧分类的指向
	// obj = $("span[is_left = 1]");
	// value = obj.attr('value');
	// class_name = obj.attr('class');

	// // 获取左侧类别
	// if (class_name == 'cate_bid') {
	// 	cate_bid = value;
	// } else if (class_name == 'cate_wbid') {
	// 	cate_wbid = value; 
	// }

	// // 判断左侧分类无类别 或 没有指定类别
	// if ( cate_bid == 'undefined' || href == 'undefined' ) {
	// 	cate_bid = '';
	// 	href = '';
	// } else if ( cate_wbid == 'undefined' || href == "undefined" ) {
	// 	cate_wbid = '';
	// 	href = '';
	// } else if ( cate_id == 'undefined' || href == "undefined" ) {
	// 	cate_id = '';
	// 	href = '';
	// }

	// // 获取上部分类的指向
	// obj = $("span[is_top = 1]");
	// cate_id = obj.attr('value');

	// // 判断上部分类无类别 或 没有指定类别
	// if ( cate_id == 'undefined' ) {
	// 	cate_id = '';
	// }

	// 判断 input 输入框跳转
	// if ( page == 'jump_page') {
	// 	page = $("input[name='jump_page']").val();
	// }

	// submitForm(href, cate_id, leftCate.cate_bid, leftCate.cate_wbid, page)

//}



</script>
